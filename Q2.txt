2.Design and develop SQL DDL and DML statements to build a database for a hospital to manage doctors, patients, and appointments.
Also execute queries for following:
1.Count how many patients each doctor has seen.
2.List patients by age descending.
3.Find doctors who have more than 3 appointments.
4.Find patients who have appointments with â€œDr. Mehta.â€
Delete appointments of patients older than 60.


-- Create Database
CREATE DATABASE IF NOT EXISTS hospital_db;
USE hospital_db;

-- Drop old tables if they exist (optional, for clean reruns)
DROP TABLE IF EXISTS Appointments;
DROP TABLE IF EXISTS Patients;
DROP TABLE IF EXISTS Doctors;

-- 1. Create Tables (DDL)

-- Table for storing doctor details
CREATE TABLE Doctors (
    doctor_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    specialization VARCHAR(100)
);

-- Table for storing patient details
CREATE TABLE Patients (
    patient_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    age INT,
    city VARCHAR(50)
);

-- Table for storing appointments between patients and doctors
CREATE TABLE Appointments (
    appointment_id INT AUTO_INCREMENT PRIMARY KEY,
    doctor_id INT,
    patient_id INT,
    appointment_date DATE,
    FOREIGN KEY (doctor_id) REFERENCES Doctors(doctor_id),
    FOREIGN KEY (patient_id) REFERENCES Patients(patient_id)
);

-- 2. Insert Sample Data (DML)

-- Insert doctor records
INSERT INTO Doctors (name, specialization) VALUES
('Dr. Mehta', 'Cardiologist'),
('Dr. Patel', 'Orthopedic'),
('Dr. Singh', 'Dermatologist'),
('Dr. Khan', 'Neurologist');

-- Insert patient records
INSERT INTO Patients (name, age, city) VALUES
('Ravi Sharma', 45, 'Mumbai'),
('Priya Verma', 32, 'Pune'),
('Anil Kapoor', 65, 'Delhi'),
('Sneha Patil', 28, 'Mumbai'),
('Amit Joshi', 55, 'Nashik'),
('Neha Desai', 40, 'Pune');

-- Insert appointments
INSERT INTO Appointments (doctor_id, patient_id, appointment_date) VALUES
(1, 1, '2025-10-10'),
(1, 2, '2025-10-12'),
(1, 3, '2025-10-15'),
(2, 4, '2025-10-18'),
(2, 5, '2025-10-20'),
(3, 6, '2025-10-25'),
(1, 4, '2025-10-28'),
(2, 3, '2025-09-15');

-- 3. Queries

-- 1ï¸âƒ£ Count how many patients each doctor has seen
SELECT 
    d.name AS doctor_name,
    COUNT(a.patient_id) AS total_patients
FROM 
    Doctors d
LEFT JOIN 
    Appointments a ON d.doctor_id = a.doctor_id
GROUP BY 
    d.name;

-- 2ï¸âƒ£ List patients by age descending
SELECT 
    name AS patient_name, 
    age, 
    city
FROM 
    Patients
ORDER BY 
    age DESC;

-- 3ï¸âƒ£ Find doctors who have more than 3 appointments
SELECT 
    d.name AS doctor_name, 
    COUNT(a.appointment_id) AS total_appointments
FROM 
    Doctors d
JOIN 
    Appointments a ON d.doctor_id = a.doctor_id
GROUP BY 
    d.name
HAVING 
    COUNT(a.appointment_id) > 3;

-- 4ï¸âƒ£ Find patients who have appointments with â€œDr. Mehtaâ€
SELECT 
    p.name AS patient_name, 
    p.age, 
    p.city
FROM 
    Patients p
JOIN 
    Appointments a ON p.patient_id = a.patient_id
JOIN 
    Doctors d ON a.doctor_id = d.doctor_id
WHERE 
    d.name = 'Dr. Mehta';

-- 5ï¸âƒ£ Delete appointments of patients older than 60
DELETE FROM 
    Appointments
WHERE 
    patient_id IN (SELECT patient_id FROM Patients WHERE age > 60);

-- Check final remaining appointments
SELECT * FROM Appointments;





ðŸ§  Explanation (Line-by-Line)
1. Create and Use Database
CREATE DATABASE IF NOT EXISTS hospital_db;
USE hospital_db;
â€¢	Creates a new database called hospital_db if it doesnâ€™t already exist.
â€¢	USE switches the active database so all subsequent commands apply to it.
________________________________________
2. Drop Existing Tables
DROP TABLE IF EXISTS Appointments;
DROP TABLE IF EXISTS Patients;
DROP TABLE IF EXISTS Doctors;
â€¢	Removes old tables if they exist, so you can re-run the script without conflicts.
________________________________________
3. Create Tables (DDL)
CREATE TABLE Doctors (
    doctor_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    specialization VARCHAR(100)
);
â€¢	Doctors table holds basic information.
â€¢	doctor_id is an auto-incremented unique ID.
â€¢	PRIMARY KEY ensures each doctor is uniquely identified.
CREATE TABLE Patients (
    patient_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    age INT,
    city VARCHAR(50)
);
â€¢	Patients table holds details of patients.
â€¢	Each patient has a unique ID.
CREATE TABLE Appointments (
    appointment_id INT AUTO_INCREMENT PRIMARY KEY,
    doctor_id INT,
    patient_id INT,
    appointment_date DATE,
    FOREIGN KEY (doctor_id) REFERENCES Doctors(doctor_id),
    FOREIGN KEY (patient_id) REFERENCES Patients(patient_id)
);
â€¢	Appointments connects doctors and patients (a relationship table).
â€¢	Foreign keys maintain referential integrity (you canâ€™t book an appointment with a non-existent doctor or patient).
________________________________________
4. Insert Sample Data (DML)
INSERT INTO Doctors (name, specialization) VALUES
('Dr. Mehta', 'Cardiologist'),
('Dr. Patel', 'Orthopedic'),
('Dr. Singh', 'Dermatologist'),
('Dr. Khan', 'Neurologist');
â€¢	Adds 4 doctors with their specializations.
INSERT INTO Patients (name, age, city) VALUES
('Ravi Sharma', 45, 'Mumbai'),
('Priya Verma', 32, 'Pune'),
('Anil Kapoor', 65, 'Delhi'),
('Sneha Patil', 28, 'Mumbai'),
('Amit Joshi', 55, 'Nashik'),
('Neha Desai', 40, 'Pune');
â€¢	Adds 6 patients with details like age and city.
INSERT INTO Appointments (doctor_id, patient_id, appointment_date) VALUES
(1, 1, '2025-10-10'),
...
(2, 3, '2025-09-15');
â€¢	Each row links a doctor to a patient with a specific appointment date.
________________________________________
5. Queries
1ï¸âƒ£ Count how many patients each doctor has seen
SELECT 
    d.name AS doctor_name,
    COUNT(a.patient_id) AS total_patients
FROM Doctors d
LEFT JOIN Appointments a ON d.doctor_id = a.doctor_id
GROUP BY d.name;
â€¢	Joins Doctors and Appointments.
â€¢	COUNT() counts patients seen by each doctor.
â€¢	LEFT JOIN ensures even doctors with no appointments are listed.
________________________________________
2ï¸âƒ£ List patients by age descending
SELECT name AS patient_name, age, city
FROM Patients
ORDER BY age DESC;
â€¢	Shows all patients ordered by age from oldest to youngest.
________________________________________
3ï¸âƒ£ Find doctors who have more than 3 appointments
SELECT d.name AS doctor_name, COUNT(a.appointment_id) AS total_appointments
FROM Doctors d
JOIN Appointments a ON d.doctor_id = a.doctor_id
GROUP BY d.name
HAVING COUNT(a.appointment_id) > 3;
â€¢	Groups doctors by name and counts appointments.
â€¢	HAVING filters only those with more than 3.
________________________________________
4ï¸âƒ£ Find patients who have appointments with â€œDr. Mehtaâ€
SELECT p.name AS patient_name, p.age, p.city
FROM Patients p
JOIN Appointments a ON p.patient_id = a.patient_id
JOIN Doctors d ON a.doctor_id = d.doctor_id
WHERE d.name = 'Dr. Mehta';
â€¢	Joins all three tables.
â€¢	Filters only those appointments where doctor name = â€œDr. Mehtaâ€.
________________________________________
5ï¸âƒ£ Delete appointments of patients older than 60
DELETE FROM Appointments
WHERE patient_id IN (SELECT patient_id FROM Patients WHERE age > 60);
â€¢	Deletes all appointments where the patientâ€™s age is greater than 60.
________________________________________
Check remaining appointments
SELECT * FROM Appointments;
â€¢	Displays the final table after deletion.

